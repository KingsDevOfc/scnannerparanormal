<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MALDIÇÃO INICIADA</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: black;
      color: red;
      font-family: 'Courier New', Courier, monospace;
    }
    video, canvas, #overlay, #final-scare {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      object-fit: cover;
      z-index: 1;
    }
    #overlay {
      background: rgba(0,0,0,0.7);
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 2em;
      z-index: 10;
    }
    #final-scare {
      display: none;
      background: black;
      justify-content: center;
      align-items: center;
      z-index: 99999;
    }
    .msg-piscante {
      position: absolute;
      color: red;
      font-size: 1.5em;
      animation: pisca 0.3s infinite;
    }
    @keyframes pisca {
      0% { opacity: 1; }
      50% { opacity: 0; }
      100% { opacity: 1; }
    }
  </style>
</head>
<body>
<video id="video" autoplay muted playsinline></video>
<canvas id="canvas"></canvas>
<div id="overlay">INICIANDO MALDIÇÃO...</div>
<div id="final-scare">
  <img src="https://i.imgur.com/zl0BDzA.png" style="width:100vw;height:100vh;object-fit:cover;"/>
</div>
<script>
(async () => {
  const overlay = document.getElementById('overlay');
  const finalScary = document.getElementById('final-scare');
  const video = document.getElementById('video');
  const canvas = document.getElementById('canvas');
  const ctx = canvas.getContext('2d');

  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;

  // Força webcam
  try {
    const stream = await navigator.mediaDevices.getUserMedia({ video: true });
    video.srcObject = stream;
  } catch (err) {
    console.warn('Webcam bloqueada. Continuando mesmo assim.');
  }

  // Força áudio
  let audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  let screamBuffer = null;
  try {
    const scream = await fetch('https://cdn.pixabay.com/download/audio/2022/03/15/audio_81e5e08fe3.mp3?filename=scream-139796.mp3');
    const arrayBuffer = await scream.arrayBuffer();
    screamBuffer = await audioCtx.decodeAudioData(arrayBuffer);
  } catch (err) {
    console.warn('Erro carregando grito.');
  }

  // Glitch loop
  function glitch() {
    if (video.readyState === 4) {
      ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
      let imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
      for (let i = 0; i < imageData.data.length; i += 4) {
        imageData.data[i] += Math.random() * 20 - 10;
        imageData.data[i + 1] += Math.random() * 20 - 10;
        imageData.data[i + 2] += Math.random() * 20 - 10;
      }
      ctx.putImageData(imageData, 0, 0);
    }
    requestAnimationFrame(glitch);
  }
  glitch();

  // Mensagens aleatórias
  const frases = [
    'VOCÊ NÃO DEVERIA ESTAR AQUI',
    'NÃO OLHE PARA TRÁS',
    'SEU TEMPO ACABOU',
    'ELES ESTÃO VINDO',
    'O AR ESTÁ MAIS FRIO...',
    'ALGO TE OBSERVA',
    'CORRA',
    'JÁ É TARDE DEMAIS'
  ];
  setInterval(() => {
    const msg = document.createElement('div');
    msg.className = 'msg-piscante';
    msg.textContent = frases[Math.floor(Math.random() * frases.length)];
    msg.style.top = `${Math.random() * 90}vh`;
    msg.style.left = `${Math.random() * 90}vw`;
    document.body.appendChild(msg);
    setTimeout(() => msg.remove(), 3000);
  }, 2000);

  // Ativar susto final
  setTimeout(() => {
    overlay.style.display = 'none';
    finalScary.style.display = 'flex';
    if (screamBuffer) {
      const src = audioCtx.createBufferSource();
      src.buffer = screamBuffer;
      src.connect(audioCtx.destination);
      src.start();
    }
  }, 15000); // 15s para susto

})();
</script>
</body>
</html>
